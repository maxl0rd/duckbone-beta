<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>flashable_view.js</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="base_classes.html">base_classes.js</a>
          <a class="source" href="bindable_field.html">bindable_field.js</a>
          <a class="source" href="bindable_view.html">bindable_view.js</a>
          <a class="source" href="collection.html">collection.js</a>
          <a class="source" href="core.js.html">core.js.erb</a>
          <a class="source" href="editable_view.html">editable_view.js</a>
          <a class="source" href="flashable_view.html">flashable_view.js</a>
          <a class="source" href="form_fields.html">form_fields.js</a>
          <a class="source" href="form_validations.html">form_validations.js</a>
          <a class="source" href="handlebars.html">handlebars.js</a>
          <a class="source" href="handlebars_extensions.html">handlebars_extensions.js</a>
          <a class="source" href="index.html">index.js</a>
          <a class="source" href="listable_view.html">listable_view.js</a>
          <a class="source" href="model.html">model.js</a>
          <a class="source" href="pageable_collection.html">pageable_collection.js</a>
          <a class="source" href="pageable_view.html">pageable_view.js</a>
          <a class="source" href="remoteable_view.js.html">remoteable_view.js.erb</a>
          <a class="source" href="routeable_application.html">routeable_application.js</a>
          <a class="source" href="simple_queue.html">simple_queue.js</a>
          <a class="source" href="stylizeable_view.html">stylizeable_view.js</a>
          <a class="source" href="syncable.html">syncable.js</a>
          <a class="source" href="template_registry.js.html">template_registry.js.erb</a>
          <a class="source" href="templateable_view.js.html">templateable_view.js.erb</a>
          <a class="source" href="validateable_field.html">validateable_field.js</a>
          <a class="source" href="view_lifecycle_extensions.html">view_lifecycle_extensions.js</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>flashable_view.js</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-Duckbone.FlashableView'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Duckbone.FlashableView">&#182;</a>
        </div>
        <h1>Duckbone.FlashableView</h1>

<p>Enables any view or application to manage a set of flash messages.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="nx">Duckbone</span><span class="p">.</span><span class="nx">FlashableView</span> <span class="o">=</span> <span class="p">{</span></pre></div>
      </td>
    </tr>
    <tr id='section-property_isFlashableView'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-property_isFlashableView">&#182;</a>
        </div>
        <h4>property isFlashableView</h4>

<p>Indicates a view that includes this mixin.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">isFlashableView</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></pre></div>
      </td>
    </tr>
    <tr id='section-function_configureFlash'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-function_configureFlash">&#182;</a>
        </div>
        <h4>function configureFlash</h4>

<p>Accepts the following options:
&ndash; container &ndash; the DOM element to insert flash messages into
&ndash; noticeTemplate &ndash; a Handlebars template or template string for the notice
&ndash; alertTemplate &ndash; a Handlebars template or template string for the notice
&ndash; noticeDuration &ndash; a default duration for a flash notice
&ndash; fadeDuration &ndash; fade time for clearing notices</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">configureFlash</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span> <span class="k">throw</span><span class="p">(</span><span class="s2">&quot;configureFlash called without a container&quot;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">flashOptionsDefaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">noticeDuration</span><span class="o">:</span> <span class="mi">10000</span><span class="p">,</span> <span class="nx">fadeDuration</span><span class="o">:</span> <span class="mi">300</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">flashOptionsDefaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
      <span class="nx">FlashView</span><span class="p">.</span><span class="nx">fadeDuration</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">.</span><span class="nx">fadeDuration</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">noticeTemplate</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">noticeTemplate</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">FlashNoticeView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">templateData</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">noticeTemplate</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">noticeTemplate</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">FlashNoticeView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">noticeTemplate</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">errorTemplate</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">errorTemplate</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">FlashErrorView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">templateData</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">errorTemplate</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">errorTemplate</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">FlashErrorView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">errorTemplate</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-function_flashNotice'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-function_flashNotice">&#182;</a>
        </div>
        <h4>function flashNotice</h4>

<ul>
<li>message &ndash; displays the given flash message</li>
<li>duration &ndash; flash notice fades out after the given number of ms</li>
<li>returns &ndash; the flash notice view</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">flashNotice</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">duration</span> <span class="o">=</span> <span class="nx">duration</span> <span class="o">||</span> <span class="mi">10000</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">flash</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FlashNoticeView</span><span class="p">({</span>
        <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">,</span>
        <span class="nx">duration</span><span class="o">:</span> <span class="nx">duration</span>
      <span class="p">});</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">.</span><span class="nx">container</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">flash</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="nx">flash</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">hide</span><span class="p">().</span><span class="nx">slideDown</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">flash</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-function_flashAlert'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-function_flashAlert">&#182;</a>
        </div>
        <h4>function flashAlert</h4>

<ul>
<li>message &ndash; displays the given flash message</li>
<li>returns &ndash; the flash notice view</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">flashAlert</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">flash</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FlashAlertView</span><span class="p">({</span>
        <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span>
      <span class="p">});</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">.</span><span class="nx">container</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">flash</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="nx">flash</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">hide</span><span class="p">().</span><span class="nx">slideDown</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">flash</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-function_clearFlashes'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-function_clearFlashes">&#182;</a>
        </div>
        <h4>function clearFlashes</h4>

<p>Clears all flash notices and alerts.</p>

<ul>
<li>immediately &ndash; instantly hides the flashes.  otherwise they are
faded out according to the fadeDuration</li>
</ul>

<p>This is called on each loadView</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">clearFlashes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">targets</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">.</span><span class="nx">container</span><span class="p">).</span>
        <span class="nx">find</span><span class="p">(</span><span class="s1">&#39;div.flash_notice, div.flash_alert&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">targets</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">targets</span><span class="p">.</span><span class="nx">fadeOut</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">flashOptions</span><span class="p">.</span><span class="nx">fadeDuration</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

  <span class="p">};</span></pre></div>
      </td>
    </tr>
    <tr id='section-Internal_Flash_Notice_and_Error_Views'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Internal_Flash_Notice_and_Error_Views">&#182;</a>
        </div>
        <h3>Internal Flash Notice and Error Views</h3>

      </td>
      <td class=code>
        <div class='highlight'><pre>   <span class="kd">var</span> <span class="nx">FlashView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
     <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
       <span class="s1">&#39;click a.close&#39;</span><span class="o">:</span> <span class="s1">&#39;dismiss&#39;</span>
     <span class="p">},</span>
     <span class="nx">fadeDuration</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
     <span class="nx">beforeTwirl</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span>
         <span class="nx">message</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">message</span>
       <span class="p">});</span>
     <span class="p">},</span>
     <span class="nx">dismiss</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
       <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fadeDuration</span><span class="p">);</span>
       <span class="nx">_</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">,</span> <span class="k">this</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">fadeDuration</span><span class="p">);</span>
       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
     <span class="p">}</span>
   <span class="p">});</span>

   <span class="nx">Duckbone</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">FlashView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Duckbone</span><span class="p">.</span><span class="nx">TemplateableView</span><span class="p">);</span>

   <span class="kd">var</span> <span class="nx">genericFlashTemplate</span> <span class="o">=</span> <span class="s1">&#39;&lt;div class=&quot;message&quot;&gt;{{{message}}}&lt;/div&gt;\</span>
<span class="s1">     &lt;div class=&quot;close&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;close&quot;&gt;X&lt;/a&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>

   <span class="kd">var</span> <span class="nx">FlashNoticeView</span> <span class="o">=</span> <span class="nx">FlashView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
     <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;flash_notice&#39;</span><span class="p">,</span>
     <span class="nx">templateData</span><span class="o">:</span> <span class="nx">genericFlashTemplate</span><span class="p">,</span>
     <span class="nx">afterInitialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">_</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dismiss</span><span class="p">,</span> <span class="k">this</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">duration</span><span class="p">);</span>
       <span class="p">}</span>
     <span class="p">}</span>
   <span class="p">});</span>

   <span class="kd">var</span> <span class="nx">FlashAlertView</span> <span class="o">=</span> <span class="nx">FlashView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
     <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;flash_alert&#39;</span><span class="p">,</span>
     <span class="nx">templateData</span><span class="o">:</span> <span class="nx">genericFlashTemplate</span>
   <span class="p">});</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">();</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
